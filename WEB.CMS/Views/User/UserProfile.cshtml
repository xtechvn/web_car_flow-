@{
    Layout = null;
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@using Entities.Models
@using Entities.ViewModels
@model UserDataViewModel
@{
    var RoleList = (List<Role>)ViewBag.RoleList;
    var _UserPosition = (List<UserPosition>)ViewBag.UserPosition;
}
<style>
    #magnific-popup-large.user-popup.popup-width2 {
        width: 950px !important;
        max-width: 95vw !important;
    }

    #magnific-popup-large .magnific-body {
        display: block !important;
        width: 100%;
    }

    /* --- FORM GIAO DIỆN ĐẸP --- */
    #form-user-profile {
        background: #fff;
        padding: 25px 30px;
        border-radius: 8px;
        font-family: "Segoe UI", Arial, sans-serif;
    }

        #form-user-profile h2 {
            font-size: 18px;
            font-weight: 600;
            color: #222;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
        }

    .form-wrapper {
        display: flex;
        gap: 40px;
    }

    .col {
        flex: 1;
    }

    /* ảnh đại diện */
    .avatar-box {
        text-align: center;
        margin-bottom: 20px;
    }

        .avatar-box img {
            width: 100px;
            height: 100px;
            border: 1px solid #ccc;
            border-radius: 6px;
            object-fit: cover;
        }

        .avatar-box label {
            color: #007bff;
            font-size: 13px;
            margin-top: 6px;
            display: inline-block;
            cursor: pointer;
        }

    /* Dòng thông tin */
    .form-row {
        display: flex;
        border-bottom: 1px solid #e6e6e6;
        padding: 6px 0;
        align-items: center;
    }

        .form-row label {
            width: 35%;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        .form-row input,
        .form-row p {
            flex: 1;
            border: none;
            background: transparent;
            font-size: 14px;
            color: #222;
            padding: 4px 0;
            outline: none;
        }

            .form-row input[type="text"],
            .form-row input[type="email"],
            .form-row input[type="tel"] {
                border-bottom: 1px solid #ddd;
            }

            .form-row input:focus {
                border-bottom-color: #007bff;
            }

            .form-row input[disabled] {
                background: transparent;
                color: #555;
            }

        .form-row .radio-group {
            display: flex;
            gap: 20px;
            align-items: center;
        }

    /* Nút */
    .form-actions {
        text-align: right;
        margin-top: 25px;
    }

    .btn {
        padding: 7px 16px;
        border: none;
        border-radius: 4px;
        font-size: 14px;
        cursor: pointer;
    }

    .btn-primary {
        background: #007bff;
        color: #fff;
    }

        .btn-primary:hover {
            background: #0069d9;
        }

    .btn-secondary {
        background: #eee;
        color: #333;
    }

        .btn-secondary:hover {
            background: #ddd;
        }
</style>

<form id="form-user-profile">
    <h2>Thông tin cá nhân</h2>

    <div class="form-wrapper">

        <!-- Cột trái -->
        <div class="col">
            @* <div class="avatar-box"> *@
            @*     <img class="img-preview" src="@(Model.Avata ?? string.Empty)" onerror="_imageError(this)" /> *@
            @*     <br /> *@
            @*     <label> *@
            @*         <input type="file" name="imagefile" onchange="_account.OnChangeImage()" hidden /> *@
            @*         Chọn ảnh *@
            @*     </label> *@
            @* </div> *@
            <input type="text" style="display:none" asp-for="@Model.Id" />
            <input type="text" style="display:none" asp-for="@Model.Status" />
            <input type="text" style="display:none" asp-for="@Model.Password" />
            <input type="text" style="display:none" asp-for="@Model.DepartmentId" />
            <input type="text" style="display:none" asp-for="@Model.UserPositionId" />
            <div class="form-row">
                <label>Họ tên</label>
                <input type="text" asp-for="@Model.FullName" />
            </div>

            <div class="form-row">
                <label>Tên đăng nhập</label>
                <input type="text" asp-for="@Model.UserName" disabled />
            </div>

            <div class="form-row">
                <label>Email</label>
                <input type="email" asp-for="@Model.Email" />
            </div>

            <div class="form-row">
                <label>Phòng ban</label>
                <input type="text" value="@Model.DepartmentName" disabled />
            </div>

            <div class="form-row">
                <label>Vai trò</label>
                <p>
                    @foreach (var item in RoleList.Select(s => s.Name))
                    {
                        @item

                        <br />
                    }
                </p>
            </div>

            <div class="form-row">
                <label>Chức vụ</label>
                @{
                    var detail = _UserPosition?.FirstOrDefault(s => s.Rank == Model.Level);
                }
                <p>@detail?.Name</p>
            </div>
        </div>

        <!-- Cột phải -->
        <div class="col">
            <div class="form-row">
                <label>Điện thoại</label>
                <input type="tel" asp-for="@Model.Phone" />
            </div>

            <div class="form-row">
                <label>Địa chỉ</label>
                <input type="text" asp-for="@Model.Address" />
            </div>

            <div class="form-row">
                <label>Ngày sinh</label>
                <input type="text" name="BirthDayPicker"
                       value="@(Model.BirthDay == null ? "" : ((DateTime)Model.BirthDay).ToString("dd/MM/yyyy"))" />
            </div>

            <div class="form-row">
                <label>Giới tính</label>
                <div class="radio-group">
                    <label><input type="radio" asp-for="@Model.Gender" value="1" /> Nam</label>
                    <label><input type="radio" asp-for="@Model.Gender" value="0" /> Nữ</label>
                </div>
            </div>

            <div class="form-row">
                <label>Tài khoản Telegram</label>
                <input type="text" asp-for="@Model.NickName" />
            </div>

            <div class="form-row">
                <label>Ghi chú</label>
                <input type="text" asp-for="@Model.Note" />
            </div>
        </div>
    </div>

    <div class="form-actions">
        <button type="button" class="btn btn-primary" onclick="_account.OnUpdate()">
            💾 Lưu
        </button>
        <button type="button" class="btn btn-secondary" onclick="$.magnificPopup.close()">
            ✖ Bỏ qua
        </button>
    </div>
</form>


<script type="text/javascript" defer>
    $('.datepicker-input').daterangepicker({
        singleDatePicker: true,
        showDropdowns: true,
        minYear: 1901,
        maxYear: parseInt(moment().format('YYYY'), 10),
        locale: { format: 'DD/MM/YYYY' }
    }, function (start) {
        $(this).val(start.format('DD/MM/YYYY'));
    });
</script>
